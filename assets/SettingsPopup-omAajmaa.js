import{G as ee,I as te,r as P,J as ne,e as p,E as ae,c as I,o as B,a as v,d as Y,x as L,y,K as se,A as F,L as O,M as re,v as oe,N as le,f as ie,D as ce,O as ue,B as U,t as q,_ as G,F as J,s as K,P as de}from"./index-Ip9iXL88.js";import{u as W}from"./utils-CltBBt4p.js";import{_ as X}from"./Chip.vue_vue_type_script_setup_true_lang-CsFwq1hP.js";function pe(C){const{input:n,isStreaming:t,currentThreadId:l,addMessage:o,patchMessage:s,appendContent:u,appendAiHighlight:m,setStreaming:d,createThread:x,updateSuggestedQuestions:i,activeTab:r,onSubmitReport:g}=C,a=ee(),w=te(),h=P(null),D=new ne({transport:"sse"});async function c(H,e,S){const V=l.value;if(V){let M=S,k,A;return new Promise((E,_)=>{var R,z;const T=D.stream$(V,H,{signal:(R=h.value)==null?void 0:R.signal}).subscribe({next:b=>{var N,Q;if(b.type==="message"&&b.data){const f=b.data;!f.isComplete&&f.content&&u(e,f.content),!f.isComplete&&f.summary&&m(e,f.summary),f.isComplete&&(f.references&&(M=f.references.map(j=>({name:j.title,content:j.content,score:j.relevanceScore,extra:j.extra}))),f.recommendations&&(k=f.recommendations),f.messageId&&(A=f.messageId))}b.type==="error"&&(s(e,{pending:!1,error:((N=b.error)==null?void 0:N.message)||"Unknown error"}),d(!1),_(new Error(((Q=b.error)==null?void 0:Q.message)||"Stream error")))},error:b=>{s(e,{pending:!1,error:b instanceof Error?b.message:"Unknown error"}),d(!1),_(b)},complete:()=>{s(e,{id:A||e,pending:!1,sources:M.length>0?M:void 0}),i&&k&&i(V,k),E()}});(z=h.value)==null||z.signal.addEventListener("abort",()=>{T.unsubscribe()})})}s(e,{pending:!1,sources:S.length>0?S:void 0})}async function $(H){var E;const e=H.trim();if(!e||t.value)return;if(r==="generate-report"&&g){g(e);return}!l.value&&x&&await x(e,"chat"),n.value="";const V={id:W(),role:"user",content:e,createdAt:Date.now()};o(V);const M=l.value;if(M){const _=w.path,T=`/chat/${M}`;_!==T&&!_.includes(M)&&a.replace(T)}const k=W();o({id:k,role:"assistant",content:"",createdAt:Date.now(),pending:!0}),(E=h.value)==null||E.abort(),h.value=new AbortController,d(!0);let A=[];try{await c(e,k,A)}catch(_){const T=_ instanceof Error?_.message:String(_);s(k,{pending:!1,error:T})}finally{d(!1)}}function Z(){h.value&&(h.value.abort(),d(!1))}return{submit:$,stopStreaming:Z,abortController:p(()=>h.value)}}function ge(C){const{modelValue:n,variant:t,activeTab:l,isFocused:o}=C,s=()=>typeof n=="function"?n():n.value,u=()=>(typeof t=="function"?t():t==null?void 0:t.value)??"chat",m=()=>typeof l=="function"?l():l==null?void 0:l.value,d=()=>typeof o=="function"?o():(o==null?void 0:o.value)??!1,x=p(()=>s().trim().length>0),i=p(()=>{if(!d())return"var(--gray-200)";const c=m();return c?c==="chat"?"var(--cobalt-600)":"var(--violet-600)":"var(--gray-200)"}),r=p(()=>{const c="flex items-center bg-white border transition-colors";return u()==="chat"?`${c} gap-3 rounded-[24px]`:`${c} gap-4 rounded-[16px]`}),g=p(()=>{const c=u();return{borderColor:i.value,padding:c==="chat"?"8px 8px 8px 16px":"16px 16px 16px 24px"}}),a=p(()=>"flex-1 bg-transparent text-gray-900 placeholder:text-gray-600 focus:outline-none text-sm leading-5"),w=p(()=>{const c="flex items-center justify-center cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed transition-opacity";return u()==="chat"?`${c} pr-1`:c}),h=p(()=>x.value?i.value:"var(--gray-200)"),D=p(()=>x.value?"var(--white)":"var(--gray-600)");return{canSubmit:x,borderColor:i,containerClass:r,containerStyle:g,inputClass:a,buttonClass:w,sendIconBgColor:h,sendIconPathColor:D}}function Ve(C={}){const{placeholder:n,activeTab:t,variant:l,onSubmitReport:o}=C,s=ae(),u=P(""),m=P(!1),d=p({get:()=>u.value,set:e=>{u.value=e}}),x=p(()=>s.isStreaming),i=ge({modelValue:u,variant:()=>l,activeTab:()=>t,isFocused:()=>m.value}),r={input:u,isStreaming:p(()=>s.isStreaming),currentThreadId:p(()=>s.currentThreadId),addMessage:s.add,patchMessage:s.patch,appendContent:s.appendContent,appendAiHighlight:s.appendAiHighlight,setStreaming:s.setStreaming,createThread:async(e,S)=>await s.createThread(e,S),updateSuggestedQuestions:s.updateThreadSuggestedQuestions,activeTab:t,onSubmitReport:o},{submit:g,stopStreaming:a}=pe(r),w=e=>{u.value=e},h=e=>{const S=e.target;w(S.value)},D=e=>{u.value=e,c(e)};async function c(e){if(t==="generate-report"&&o){o(e);return}await g(e),u.value=""}const $=e=>{m.value=e},Z=()=>{$(!0)},H=()=>{$(!1)};return{input:d,isStreaming:x,isFocused:p(()=>m.value),placeholder:n,canSubmit:i.canSubmit,containerClass:i.containerClass,containerStyle:i.containerStyle,inputClass:i.inputClass,buttonClass:i.buttonClass,sendIconBgColor:i.sendIconBgColor,sendIconPathColor:i.sendIconPathColor,submit:c,stopStreaming:a,handleInput:h,handleFocus:Z,handleBlur:H,submitWithText:D,setValue:w,setFocused:$}}const fe={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function ve(C,n){return B(),I("svg",fe,[...n[0]||(n[0]=[v("path",{d:"M1.67508 17.5L19.1667 10L1.67508 2.5L1.66675 8.33333L14.1667 10L1.66675 11.6667L1.67508 17.5Z"},null,-1)])])}const Pe={render:ve},me={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Ce(C,n){return B(),I("svg",me,[...n[0]||(n[0]=[v("path",{d:"M3 8C3 7.44772 3.44772 7 4 7H20C20.5523 7 21 7.44772 21 8C21 8.55228 20.5523 9 20 9H4C3.44772 9 3 8.55228 3 8ZM3 16C3 15.4477 3.44772 15 4 15H14C14.5523 15 15 15.4477 15 16C15 16.5523 14.5523 17 14 17H4C3.44772 17 3 16.5523 3 16Z",fill:"#545D67"},null,-1)])])}const he={render:Ce},xe={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function be(C,n){return B(),I("svg",xe,[...n[0]||(n[0]=[v("path",{d:"M19.4298 12.98C19.4698 12.66 19.4998 12.34 19.4998 12C19.4998 11.66 19.4698 11.34 19.4298 11.02L21.5398 9.37C21.7298 9.22 21.7798 8.95 21.6598 8.73L19.6598 5.27C19.5698 5.11 19.3998 5.02 19.2198 5.02C19.1598 5.02 19.0998 5.03 19.0498 5.05L16.5598 6.05C16.0398 5.65 15.4798 5.32 14.8698 5.07L14.4898 2.42C14.4598 2.18 14.2498 2 13.9998 2H9.99984C9.74984 2 9.53984 2.18 9.50984 2.42L9.12984 5.07C8.51984 5.32 7.95984 5.66 7.43984 6.05L4.94984 5.05C4.88984 5.03 4.82984 5.02 4.76984 5.02C4.59984 5.02 4.42984 5.11 4.33984 5.27L2.33984 8.73C2.20984 8.95 2.26984 9.22 2.45984 9.37L4.56984 11.02C4.52984 11.34 4.49984 11.67 4.49984 12C4.49984 12.33 4.52984 12.66 4.56984 12.98L2.45984 14.63C2.26984 14.78 2.21984 15.05 2.33984 15.27L4.33984 18.73C4.42984 18.89 4.59984 18.98 4.77984 18.98C4.83984 18.98 4.89984 18.97 4.94984 18.95L7.43984 17.95C7.95984 18.35 8.51984 18.68 9.12984 18.93L9.50984 21.58C9.53984 21.82 9.74984 22 9.99984 22H13.9998C14.2498 22 14.4598 21.82 14.4898 21.58L14.8698 18.93C15.4798 18.68 16.0398 18.34 16.5598 17.95L19.0498 18.95C19.1098 18.97 19.1698 18.98 19.2298 18.98C19.3998 18.98 19.5698 18.89 19.6598 18.73L21.6598 15.27C21.7798 15.05 21.7298 14.78 21.5398 14.63L19.4298 12.98ZM17.4498 11.27C17.4898 11.58 17.4998 11.79 17.4998 12C17.4998 12.21 17.4798 12.43 17.4498 12.73L17.3098 13.86L18.1998 14.56L19.2798 15.4L18.5798 16.61L17.3098 16.1L16.2698 15.68L15.3698 16.36C14.9398 16.68 14.5298 16.92 14.1198 17.09L13.0598 17.52L12.8998 18.65L12.6998 20H11.2998L11.1098 18.65L10.9498 17.52L9.88984 17.09C9.45984 16.91 9.05984 16.68 8.65984 16.38L7.74984 15.68L6.68984 16.11L5.41984 16.62L4.71984 15.41L5.79984 14.57L6.68984 13.87L6.54984 12.74C6.51984 12.43 6.49984 12.2 6.49984 12C6.49984 11.8 6.51984 11.57 6.54984 11.27L6.68984 10.14L5.79984 9.44L4.71984 8.6L5.41984 7.39L6.68984 7.9L7.72984 8.32L8.62984 7.64C9.05984 7.32 9.46984 7.08 9.87984 6.91L10.9398 6.48L11.0998 5.35L11.2998 4H12.6898L12.8798 5.35L13.0398 6.48L14.0998 6.91C14.5298 7.09 14.9298 7.32 15.3298 7.62L16.2398 8.32L17.2998 7.89L18.5698 7.38L19.2698 8.59L18.1998 9.44L17.3098 10.14L17.4498 11.27ZM11.9998 8C9.78984 8 7.99984 9.79 7.99984 12C7.99984 14.21 9.78984 16 11.9998 16C14.2098 16 15.9998 14.21 15.9998 12C15.9998 9.79 14.2098 8 11.9998 8ZM11.9998 14C10.8998 14 9.99984 13.1 9.99984 12C9.99984 10.9 10.8998 10 11.9998 10C13.0998 10 13.9998 10.9 13.9998 12C13.9998 13.1 13.0998 14 11.9998 14Z",fill:"#545D67"},null,-1)])])}const ye={render:be},Le={class:"flex items-center justify-between px-3 py-4 shrink-0 bg-gray-50 dark:bg-gray-dark-100 lg:bg-transparent lg:dark:bg-transparent lg:px-5 lg:py-4 lg:justify-end"},_e={class:"flex items-center gap-2"},Ae=Y({__name:"PageHeader",emits:["openSettings","toggleSidebar","newChat"],setup(C){return(n,t)=>{const l=se("Button");return B(),I("div",Le,[v("button",{onClick:t[0]||(t[0]=o=>n.$emit("toggleSidebar")),class:"lg:hidden w-8 h-8 flex items-center justify-center hover:bg-gray-100 dark:hover:bg-gray-800 rounded-sm transition-colors cursor-pointer","aria-label":"메뉴 열기"},[L(y(he),{class:"w-6 h-6 text-[#545D67] dark:text-gray-400"})]),v("div",_e,[L(l,{variant:"text","aria-label":"새로운 채팅",class:"lg:hidden flex items-center justify-center p-1 hover:cursor-pointer",onClick:t[1]||(t[1]=o=>n.$emit("newChat"))},{default:F(()=>[L(O,{icon:y(re),size:24,color:"gray-700"},null,8,["icon"])]),_:1}),L(l,{variant:"text",class:"flex items-center justify-center p-1 hover:cursor-pointer",onClick:t[2]||(t[2]=o=>n.$emit("openSettings")),"aria-label":"설정"},{default:F(()=>[L(O,{icon:y(ye),size:24,color:"gray-700"},null,8,["icon"])]),_:1})])])}}}),we={class:"relative bg-white rounded-2xl p-5 w-70 shadow-[0px_24px_48px_6px_rgba(0,0,0,0.1),0px_8px_40px_8px_rgba(0,0,0,0.1),0px_8px_12px_-6px_rgba(0,0,0,0.14)] animate-slide-in"},Se={class:"flex flex-col gap-5"},$e={class:"flex flex-col gap-3"},Me={class:"flex flex-wrap gap-1"},ke={class:"flex flex-col gap-3"},Ie={class:"flex flex-wrap gap-1"},Be=Y({__name:"SettingsPopup",props:{initialLanguage:{default:void 0},initialDisplayMode:{default:"light"}},emits:["close","update:language","update:displayMode"],setup(C,{emit:n}){const{t}=oe(),l=C,o=n,s=[{value:"ko",label:"한국어"},{value:"en",label:"English"},{value:"zh",label:"中文"}],u=[{value:"light",label:t("settings.light")},{value:"dark",label:t("settings.dark")}],m=P(l.initialLanguage||le()),d=P(l.initialDisplayMode);ie(()=>{const r=localStorage.getItem("chat-client-display-mode");r&&(d.value=r)});const x=r=>{m.value=r,o("update:language",r)},i=r=>{d.value=r,localStorage.setItem("chat-client-display-mode",r),o("update:displayMode",r)};return(r,g)=>(B(),I("div",{class:"fixed inset-0 z-50 flex items-start justify-end py-13 px-5",onClick:g[2]||(g[2]=ce(a=>r.$emit("close"),["self"]))},[v("div",{class:"fixed inset-0 bg-black/20 animate-fade-in",onClick:g[0]||(g[0]=a=>r.$emit("close"))}),v("div",we,[v("button",{class:"absolute right-3 top-3 w-10 h-10 flex items-center justify-center hover:bg-gray-100 rounded-lg transition-colors hover:cursor-pointer",onClick:g[1]||(g[1]=a=>r.$emit("close"))},[L(y(ue),{class:"w-6 h-6 text-gray-500"})]),v("div",Se,[v("div",$e,[L(y(G),{variant:"subtitle1",color:"text-gray-900"},{default:F(()=>[U(q(y(t)("settings.language")),1)]),_:1}),v("div",Me,[(B(),I(J,null,K(s,a=>L(y(X),{key:a.value,text:a.label,variant:(m.value===a.value,"outlined"),color:m.value===a.value?"primary":"grey",class:"rounded-full cursor-pointer","class-name":m.value===a.value?"border-primary text-primary":"",onClick:w=>x(a.value)},null,8,["text","variant","color","class-name","onClick"])),64))])]),v("div",ke,[L(y(G),{variant:"subtitle1",color:"text-gray-900"},{default:F(()=>[U(q(y(t)("settings.displayMode")),1)]),_:1}),v("div",Ie,[(B(),I(J,null,K(u,a=>L(y(X),{key:a.value,text:a.label,variant:(d.value===a.value,"outlined"),color:d.value===a.value?"primary":"grey",class:"rounded-full cursor-pointer","class-name":d.value===a.value?"border-primary text-primary":"",onClick:w=>i(a.value)},null,8,["text","variant","color","class-name","onClick"])),64))])])])])]))}}),Ee=de(Be,[["__scopeId","data-v-45ffe0c1"]]);export{Pe as S,Ae as _,Ee as a,Ve as u};
